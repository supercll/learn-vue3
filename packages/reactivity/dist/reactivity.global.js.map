{
  "version": 3,
  "sources": ["../src/index.ts", "../src/effect.ts", "../../shared/src/index.ts", "../src/reactive.ts"],
  "sourcesContent": ["export { effect } from './effect'\r\nexport { reactive } from './reactive'\r\n", "export class ReactiveEffect {\r\n  public active = true\r\n  constructor(public fn) {} // \u4F60\u4F20\u9012\u7684fn\u6211\u4F1A\u5E2E\u4F60\u653E\u5230this\u4E0A\r\n  run() {\r\n    this.fn() // \u53BBproxy\u5BF9\u8C61\u4E0A\u53D6\u503C\r\n  }\r\n}\r\nexport function effect(fn) {\r\n  // \u5C06\u7528\u6237\u4F20\u9012\u7684\u51FD\u6570\u7F16\u7A0B\u54CD\u5E94\u5F0F\u7684effect\r\n  const _effect = new ReactiveEffect(fn)\r\n  _effect.run()\r\n}\r\n", "export const isObject = value => {\r\n  return typeof value === 'object' && value !== null\r\n}\r\n", "import { isObject } from '@vue/shared'\r\nconst reactiveMap = new WeakMap() // key\u5FC5\u987B\u662F\u5BF9\u8C61\uFF0C\u5F31\u5F15\u7528\r\n// v8\u7684\u5783\u573E\u56DE\u6536\u673A\u5236  \u6807\u8BB0\u5220\u9664  \u5F15\u7528\u8BA1\u6570\r\nconst enum ReactiveFlags {\r\n  IS_REACTIVE = '__v_isReactive',\r\n}\r\nexport function reactive(target) {\r\n  if (!isObject(target)) {\r\n    return target\r\n  }\r\n  // es6 \u4E2D\u7684proxy\r\n  if (target[ReactiveFlags.IS_REACTIVE]) {\r\n    return target\r\n  }\r\n  const existing = reactiveMap.get(target)\r\n  if (existing) {\r\n    return existing\r\n  }\r\n  const proxy = new Proxy(target, {\r\n    get(target, key, receiver) {\r\n      if (key === ReactiveFlags.IS_REACTIVE) {\r\n        return true\r\n      }\r\n      console.log('\u8FD9\u91CC\u53EF\u4EE5\u8BB0\u5F55\u8FD9\u4E2A\u5C5E\u6027\u4F7F\u7528\u4E86\u54EA\u4E2Aeffect')\r\n      return Reflect.get(target, key, receiver)\r\n    },\r\n    set(target, key, value, receiver) {\r\n      console.log('\u8FD9\u91CC\u53EF\u4EE5\u901A\u77E5effect\u91CD\u65B0\u6267\u884C')\r\n      return Reflect.set(target, key, value, receiver)\r\n    },\r\n  })\r\n  reactiveMap.set(target, proxy)\r\n  return proxy\r\n}\r\n// \u4E00\u4E2A\u5BF9\u8C61\u5DF2\u7ECF\u88AB\u4EE3\u7406\u8FC7\u4E86 \uFF0C\u5C31\u4E0D\u8981\u518D\u6B21\u88AB\u4EE3\u7406\u4E86\r\n// \u4F7F\u7528proxy \u8981\u642D\u914DReflect\u6765\u4F7F\u7528  obj -> proxy\r\n// \u4E0B\u6B21\u4F60\u4F20\u5165\u7684\u662Fproxy\u4E86\uFF0C\u6211\u53BB\u8FD9\u4E2A\u5BF9\u8C61\u4E0A\u53D6\u503C\u53EF\u4EE5\u547D\u4E2Dproxy\u7684get\u65B9\u6CD5\r\n\r\n/*\r\nlet person = {\r\n  name: 'lc',\r\n  get aliasName() {\r\n    // \u5C5E\u6027\u8BBF\u95EE\u5668\r\n    return this.name + 'cl'\r\n  },\r\n}\r\nlet p = new Proxy(person, {\r\n  get(target, key, receiver) {\r\n    console.log('get: ', key)\r\n    return Reflect.get(target, key, receiver)\r\n  },\r\n  set(target, key, value, receiver) {\r\n    console.log('set: ', key)\r\n    return Reflect.set(target, key, value, receiver)\r\n  },\r\n})\r\nconsole.log(p.aliasName)\r\n\r\np.name = 'newlc'\r\nconsole.log(p.aliasName)\r\n// \u539F\u56E0\u662F\u6211\u53BBproxy\u4E0A\u53D6aliasName,\u8FD9\u4E2A\u65F6\u5019\u56DE\u6267\u884Cget\u65B9\u6CD5\r\n// \u4F46\u662FaliasName \u662F\u57FA\u4E8Ename\u5C5E\u6027 \u539F\u5219\u4E0A\u5E94\u8BE5\u53BBname\u4E0A\u53D6\u503C\r\n// \u7136\u800Cthis.name \u5E76\u6CA1\u6709\u89E6\u53D1proxy\u7684get\uFF0C\u4E5F\u5C31\u610F\u5473\u7740\u7A0D\u540E\u6211\u4EEC\u4FEE\u6539name\u5C5E\u6027\u7684\u65F6\u5019\r\n// \u5C31\u4E0D\u4F1A\u5BFC\u81F4\u9875\u9762\u91CD\u65B0\u6E32\u67D3\r\n*/\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAO,MAAM,iBAAN,MAAqB;AAAA,IAE1B,YAAmB,IAAI;AAAJ;AADnB,WAAO,SAAS;AAAA,IACQ;AAAA,IACxB,MAAM;AACJ,WAAK,GAAG;AAAA,IACV;AAAA,EACF;AACO,kBAAgB,IAAI;AAEzB,UAAM,UAAU,IAAI,eAAe,EAAE;AACrC,YAAQ,IAAI;AAAA,EACd;;;ACXO,MAAM,WAAW,WAAS;AAC/B,WAAO,OAAO,UAAU,YAAY,UAAU;AAAA,EAChD;;;ACDA,MAAM,cAAc,oBAAI,QAAQ;AAKzB,oBAAkB,QAAQ;AAC/B,QAAI,CAAC,SAAS,MAAM,GAAG;AACrB,aAAO;AAAA,IACT;AAEA,QAAI,OAAO,qCAA4B;AACrC,aAAO;AAAA,IACT;AACA,UAAM,WAAW,YAAY,IAAI,MAAM;AACvC,QAAI,UAAU;AACZ,aAAO;AAAA,IACT;AACA,UAAM,QAAQ,IAAI,MAAM,QAAQ;AAAA,MAC9B,IAAI,SAAQ,KAAK,UAAU;AACzB,YAAI,QAAQ,oCAA2B;AACrC,iBAAO;AAAA,QACT;AACA,gBAAQ,IAAI,kGAAuB;AACnC,eAAO,QAAQ,IAAI,SAAQ,KAAK,QAAQ;AAAA,MAC1C;AAAA,MACA,IAAI,SAAQ,KAAK,OAAO,UAAU;AAChC,gBAAQ,IAAI,oEAAkB;AAC9B,eAAO,QAAQ,IAAI,SAAQ,KAAK,OAAO,QAAQ;AAAA,MACjD;AAAA,IACF,CAAC;AACD,gBAAY,IAAI,QAAQ,KAAK;AAC7B,WAAO;AAAA,EACT;",
  "names": []
}
